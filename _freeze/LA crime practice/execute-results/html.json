{
  "hash": "38b3ac01ff36214004b599bf8af8f0e1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"LA Crime\"\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggtext)\nlibrary(showtext)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: sysfonts\nLoading required package: showtextdb\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.12.2, GDAL 3.9.3, PROJ 9.4.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(glue)\nlibrary(cowplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'cowplot'\n\nThe following object is masked from 'package:lubridate':\n\n    stamp\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Add Google fonts\nfont_add_google(\"Roboto Condensed\", family = \"Roboto\")\nfont <- \"Roboto\"\n\n# Automatically enable the use of showtext for all plots\nshowtext_auto()\n\n# Add local font\nfont_add(\"Font Awesome 6 Brands\", here::here(\"fonts/otfs/Font Awesome 6 Brands-Regular-400.otf\"))\n\n# Set DPI for high-resolution text rendering\nshowtext_opts(dpi = 300)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read data\ndf <- read_csv(\"Data/Crime_Data_from_2020_to_Present_20250224.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 1005050 Columns: 28\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (16): Date Rptd, DATE OCC, TIME OCC, AREA, AREA NAME, Rpt Dist No, Crm C...\ndbl (11): DR_NO, Part 1-2, Crm Cd, Vict Age, Premis Cd, Weapon Used Cd, Crm ...\nlgl  (1): Crm Cd 4\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Examine the data\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     DR_NO            Date Rptd           DATE OCC           TIME OCC        \n Min.   :      817   Length:1005050     Length:1005050     Length:1005050    \n 1st Qu.:210616878   Class :character   Class :character   Class :character  \n Median :220915952   Mode  :character   Mode  :character   Mode  :character  \n Mean   :220223531                                                           \n 3rd Qu.:231110366                                                           \n Max.   :252104053                                                           \n                                                                             \n     AREA            AREA NAME         Rpt Dist No           Part 1-2  \n Length:1005050     Length:1005050     Length:1005050     Min.   :1.0  \n Class :character   Class :character   Class :character   1st Qu.:1.0  \n Mode  :character   Mode  :character   Mode  :character   Median :1.0  \n                                                          Mean   :1.4  \n                                                          3rd Qu.:2.0  \n                                                          Max.   :2.0  \n                                                                       \n     Crm Cd      Crm Cd Desc          Mocodes             Vict Age     \n Min.   :110.0   Length:1005050     Length:1005050     Min.   : -4.00  \n 1st Qu.:331.0   Class :character   Class :character   1st Qu.:  0.00  \n Median :442.0   Mode  :character   Mode  :character   Median : 30.00  \n Mean   :500.1                                         Mean   : 28.92  \n 3rd Qu.:626.0                                         3rd Qu.: 44.00  \n Max.   :956.0                                         Max.   :120.00  \n                                                                       \n   Vict Sex         Vict Descent         Premis Cd     Premis Desc       \n Length:1005050     Length:1005050     Min.   :101.0   Length:1005050    \n Class :character   Class :character   1st Qu.:101.0   Class :character  \n Mode  :character   Mode  :character   Median :203.0   Mode  :character  \n                                       Mean   :305.6                     \n                                       3rd Qu.:501.0                     \n                                       Max.   :976.0                     \n                                       NA's   :16                        \n Weapon Used Cd   Weapon Desc           Status          Status Desc       \n Min.   :101.0    Length:1005050     Length:1005050     Length:1005050    \n 1st Qu.:311.0    Class :character   Class :character   Class :character  \n Median :400.0    Mode  :character   Mode  :character   Mode  :character  \n Mean   :363.9                                                            \n 3rd Qu.:400.0                                                            \n Max.   :516.0                                                            \n NA's   :677816                                                           \n    Crm Cd 1        Crm Cd 2         Crm Cd 3       Crm Cd 4      \n Min.   :110.0   Min.   :210.0    Min.   :310       Mode:logical  \n 1st Qu.:331.0   1st Qu.:998.0    1st Qu.:998       NA's:1005050  \n Median :442.0   Median :998.0    Median :998                     \n Mean   :499.9   Mean   :958.1    Mean   :984                     \n 3rd Qu.:626.0   3rd Qu.:998.0    3rd Qu.:998                     \n Max.   :956.0   Max.   :999.0    Max.   :999                     \n NA's   :11      NA's   :935908   NA's   :1002735                 \n   LOCATION         Cross Street            LAT             LON        \n Length:1005050     Length:1005050     Min.   : 0.00   Min.   :-118.7  \n Class :character   Class :character   1st Qu.:34.01   1st Qu.:-118.4  \n Mode  :character   Mode  :character   Median :34.06   Median :-118.3  \n                                       Mean   :34.00   Mean   :-118.1  \n                                       3rd Qu.:34.16   3rd Qu.:-118.3  \n                                       Max.   :34.33   Max.   :   0.0  \n                                                                       \n```\n\n\n:::\n\n```{.r .cell-code}\nskim(df)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |        |\n|:------------------------|:-------|\n|Name                     |df      |\n|Number of rows           |1005050 |\n|Number of columns        |28      |\n|_______________________  |        |\n|Column type frequency:   |        |\n|character                |16      |\n|logical                  |1       |\n|numeric                  |11      |\n|________________________ |        |\n|Group variables          |None    |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|Date Rptd     |         0|          1.00|  22|  22|     0|     1869|          0|\n|DATE OCC      |         0|          1.00|  22|  22|     0|     1863|          0|\n|TIME OCC      |         0|          1.00|   4|   4|     0|     1439|          0|\n|AREA          |         0|          1.00|   2|   2|     0|       21|          0|\n|AREA NAME     |         0|          1.00|   6|  11|     0|       21|          0|\n|Rpt Dist No   |         0|          1.00|   4|   4|     0|     1210|          0|\n|Crm Cd Desc   |         0|          1.00|   5|  56|     0|      140|          0|\n|Mocodes       |    151692|          0.85|   4|  49|     0|   310895|          0|\n|Vict Sex      |    144720|          0.86|   1|   1|     0|        5|          0|\n|Vict Descent  |    144732|          0.86|   1|   1|     0|       20|          0|\n|Premis Desc   |       588|          1.00|   4|  63|     0|      306|          0|\n|Weapon Desc   |    677816|          0.33|   3|  46|     0|       79|          0|\n|Status        |         1|          1.00|   2|   2|     0|        6|          0|\n|Status Desc   |         0|          1.00|   3|  12|     0|        6|          0|\n|LOCATION      |         0|          1.00|   1|  40|     0|    66566|          0|\n|Cross Street  |    850816|          0.15|   1|  34|     0|    10413|          0|\n\n\n**Variable type: logical**\n\n|skim_variable | n_missing| complete_rate| mean|count |\n|:-------------|---------:|-------------:|----:|:-----|\n|Crm Cd 4      |   1005050|             0|  NaN|:     |\n\n\n**Variable type: numeric**\n\n|skim_variable  | n_missing| complete_rate|         mean|          sd|      p0|          p25|          p50|          p75|         p100|hist  |\n|:--------------|---------:|-------------:|------------:|-----------:|-------:|------------:|------------:|------------:|------------:|:-----|\n|DR_NO          |         0|          1.00| 220223531.33| 13194714.51|  817.00| 210616878.25| 220915952.50| 231110365.75| 252104053.00|▁▁▁▂▇ |\n|Part 1-2       |         0|          1.00|         1.40|        0.49|    1.00|         1.00|         1.00|         2.00|         2.00|▇▁▁▁▆ |\n|Crm Cd         |         0|          1.00|       500.14|      205.26|  110.00|       331.00|       442.00|       626.00|       956.00|▂▇▂▅▂ |\n|Vict Age       |         0|          1.00|        28.92|       21.99|   -4.00|         0.00|        30.00|        44.00|       120.00|▆▇▃▁▁ |\n|Premis Cd      |        16|          1.00|       305.61|      219.30|  101.00|       101.00|       203.00|       501.00|       976.00|▇▁▅▁▁ |\n|Weapon Used Cd |    677816|          0.33|       363.95|      123.74|  101.00|       311.00|       400.00|       400.00|       516.00|▂▁▁▇▃ |\n|Crm Cd 1       |        11|          1.00|       499.90|      205.06|  110.00|       331.00|       442.00|       626.00|       956.00|▂▇▂▅▂ |\n|Crm Cd 2       |    935908|          0.07|       958.11|      110.36|  210.00|       998.00|       998.00|       998.00|       999.00|▁▁▁▁▇ |\n|Crm Cd 3       |   1002735|          0.00|       984.02|       52.34|  310.00|       998.00|       998.00|       998.00|       999.00|▁▁▁▁▇ |\n|LAT            |         0|          1.00|        34.00|        1.61|    0.00|        34.01|        34.06|        34.16|        34.33|▁▁▁▁▇ |\n|LON            |         0|          1.00|      -118.09|        5.58| -118.67|      -118.43|      -118.32|      -118.27|         0.00|▇▁▁▁▁ |\n\n\n:::\n\n```{.r .cell-code}\n# Wrangle/Clean data\ndf_clean <- df %>%\n  clean_names()\n\ndf_clean <- df_clean %>%\n  drop_na(dr_no) %>%\n  mutate(date_occ = date(mdy_hms(date_occ)),\n         month = month(date_occ),\n         year = year(date_occ),\n         time_of_day = case_when(\n           between(time_occ, \"0400\", \"1159\") ~ \"Morning\",\n           between(time_occ, \"1200\", \"1959\") ~ \"Afternoon/Evening\",\n           TRUE ~ \"Night\"\n         )) %>%\n  select(dr_no, month, year, area_name, time_of_day, crm_cd_desc, status_desc, lat, lon)\n\ndf_crime <- st_as_sf(df_clean, coords = c(\"lon\", \"lat\"), crs = 4326)\n\ndf_crime_nopoint <- df_clean %>%\n  select(-c(lat, lon))\n\nla_divisions <- st_read(\"Data/LAPD Divisions/LAPD_Divisions.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `LAPD_Divisions' from data source \n  `C:\\Users\\gonza\\OneDrive - csulb\\Documents\\Andres Portfolio\\Data\\LAPD Divisions\\LAPD_Divisions.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 21 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 6359577 ymin: 1714641 xmax: 6514633 ymax: 1945515\nProjected CRS: NAD83 / California zone 5 (ftUS)\n```\n\n\n:::\n\n```{.r .cell-code}\nla_divisions <- la_divisions %>%\n  st_transform(la_divisions, crs = 4326) %>%\n  mutate(APREC = str_to_title(APREC),\n         APREC = case_when(\n           APREC == \"North Hollywood\" ~ \"N Hollywood\",\n           APREC == \"West Los Angeles\" ~ \"West LA\",\n           TRUE ~ APREC\n         ))\n\nla_crime_map <- left_join(la_divisions, df_crime_nopoint,\n                          by = c(\"APREC\" = \"area_name\")) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolor <- \"#4169E1\"\n\n# Generate a social media caption with custom colors and font styling\nsocial <- andresutils::social_caption(font_family = font, icon_color = color, font_color = \"grey40\", bg_color = \"#ffffff\") \n\n# Construct the final plot caption with TidyTuesday details, data source, and social caption\ncap <- paste0(\n  \"**Source**: data.lacity.org | **Graphic**: \", social\n)\n\ndf_crime_nopoint %>%\n  group_by(crm_cd_desc) %>%\n  count() %>%\n  ungroup() %>%\n  mutate(crm_cd_desc = str_to_title(crm_cd_desc)) %>%\n  slice_max(n, n = 10) %>%\n  ggplot(aes(x = reorder(crm_cd_desc, n), y = n)) +\n  geom_bar(stat = \"identity\", fill = color, width = 0.8) +\n  geom_text(aes(y = 1500, label = scales::label_number(scale = 1e-3, accuracy = 0.1)(n)), hjust = 0, family = font, size = 3.2, color = \"white\") +\n  geom_rect(xmin = 11.45, xmax = 12.01, ymin = -4500, ymax = 9200, fill = color) +\n  labs(\n    title = \"Top Reported Crime Categories in <span style='color:white;'>Los Angeles</span> (2020 - Feb 19, 2025)\",\n    subtitle = \"Vehicle theft leads as the most reported crime. Total reported crimes, in thousands:\",\n    caption = cap,\n    x = NULL, y = NULL) +\n  scale_y_continuous(expand = c(0,0)) +\n  coord_flip(clip = \"off\") +\n  theme_minimal(base_size = 10, base_family = font) +\n  theme(\n    panel.grid = element_blank(),\n    axis.text.x = element_blank(),\n    axis.text.y = element_text(hjust = 0),\n    plot.title.position = \"plot\",\n    plot.title = element_markdown(face = \"bold\", size = 12),\n    plot.caption.position = \"plot\",\n    plot.caption = element_markdown(hjust = 0, size = 5.5, color = \"grey40\")\n  )\n```\n\n::: {.cell-output-display}\n![](LA-crime-practice_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"lol.png\", width = 10, height = 4, bg = \"#ffffff\")\n```\n:::\n",
    "supporting": [
      "LA-crime-practice_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}