{
  "hash": "4f982a9824742ff16d5e0fe8afba2a41",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Global Patterns in Tuberculosis Incidence and Mortality\"\ndescription: \"A visualization exploring how TB incidence and mortality vary across WHO regions, revealing unequal disease burdens around the world. Population size and regional differences highlight the complex dynamics behind global TB outcomes.\"\nlightbox: true\ndate: November 12, 2025\ncategories: [TidyTuesday, Global Health, Epidemiology, Data Visualization, R Programming]\ntags: [ggplot2, tidyverse, gganimate, public-health, who-data, data-visualization]\nimage: \"tt_45_2025.png\"\neditor_options: \n  chunk_output_type: inline\n---\n\n![Animated visualization showing TB incidence and mortality from 2000 to 2023 across WHO regions. Each frame displays a faceted scatterplot for a single year, with point size representing population and revealing major regional differences in disease burden over time.](tt_45_2025.gif){#fig-1}\n\n### <mark> **How This Graphic Was Made** </mark>\n\n#### 1. ðŸ“¦ Load Packages & Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary packages using pacman for easier dependency management\npacman::p_load(\n  tidyverse,   # Collection of R packages for data science (ggplot2, dplyr, etc.)\n  showtext,    # Enables custom fonts for ggplot2\n  ggtext,      # Adds rich text formatting to ggplot2\n  skimr,       # Provides summary statistics in a readable format\n  glue,\n  janitor,\n  gganimate,\n  ggrepel,\n  legendry\n)\n\n# Add Google fonts\nfont_add_google(\"Oswald\", family = \"Oswald\")\nfont_add_google(\"Roboto Condensed\", family = \"Roboto\")\n\n# Add local font\nfont_add(\"Font Awesome 6 Brands\", here::here(\"fonts/otfs/Font Awesome 6 Brands-Regular-400.otf\"))\n\n# Automatically enable the use of showtext for all plots\nshowtext_auto()\n\n# Set DPI for high-resolution text rendering\nshowtext_opts(dpi = 300)\n```\n:::\n\n\n#### 2. ðŸ“– Read in the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the TidyTuesday data\ntuesdata <- tidytuesdayR::tt_load(2025, week = 45)\n\n# Extract dataset and clean column names\nwho_tb_data <- tuesdata$who_tb_data %>% clean_names()\n\n# Show the README for context\ntidytuesdayR::readme(tuesdata)\n\n# Drop the list to free memory\nrm(tuesdata)\n```\n:::\n\n\n#### 3. ðŸ•µï¸ Examine the Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(who_tb_data)\nskim(who_tb_data)\n```\n:::\n\n\n#### 4. ðŸ¤¼ Wrangle Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwho_tb_data %>%\n  filter(is.na(e_mort_100k))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 24 Ã— 18\n   country   g_whoregion iso_numeric iso2  iso3   year c_cdr c_newinc_100k   cfr\n   <chr>     <chr>             <dbl> <chr> <chr> <dbl> <dbl>         <dbl> <dbl>\n 1 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2000    28           144  0.31\n 2 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2001    24           123  0.33\n 3 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2002    33           168  0.3 \n 4 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2003    40           205  0.27\n 5 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2004    36           184  0.28\n 6 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2005    34           175  0.29\n 7 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2006    35           182  0.29\n 8 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2007    47           239  0.24\n 9 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2008    57           293  0.2 \n10 Democratâ€¦ South-Eastâ€¦         408 KP    PRK    2009    60           307  0.19\n# â„¹ 14 more rows\n# â„¹ 9 more variables: e_inc_100k <dbl>, e_inc_num <dbl>, e_mort_100k <dbl>,\n#   e_mort_exc_tbhiv_100k <dbl>, e_mort_exc_tbhiv_num <dbl>, e_mort_num <dbl>,\n#   e_mort_tbhiv_100k <dbl>, e_mort_tbhiv_num <dbl>, e_pop_num <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\nwho_tb_data <- who_tb_data %>%\n  drop_na(e_mort_100k)\n\nhighlighted_countries <- who_tb_data %>%\n  filter(year == max(year)) %>%\n  group_by(g_whoregion) %>%\n  slice_max(e_inc_100k, n = 5, with_ties = FALSE) %>%\n  ungroup() %>%\n  pull(country)\n```\n:::\n\n\n#### 5. ðŸ”¤ Text\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncap <- \"Week 45, 2025 | Source: World Health Organization Global Tuberculosis Report | Graphic by Andres Gonzalez\"\n```\n:::\n\n\n#### 6. ðŸ“Š Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- who_tb_data %>%\n  ggplot(aes(x = e_inc_100k, y = e_mort_100k)) +\n  facet_wrap( ~ g_whoregion, scales = \"free\") +\n  geom_point(\n    data = ~ filter(., !country %in% highlighted_countries),\n    aes(\n      size = e_pop_num,\n      colour = g_whoregion,\n      fill = stage(g_whoregion, after_scale = alpha(colorspace::desaturate(fill, 0.4), 0.2))\n    ),\n    shape = 21,\n    stroke = 0.2\n  ) +\n  geom_point(\n    data = ~ filter(., country %in% highlighted_countries),\n    aes(size = e_pop_num, fill = g_whoregion),\n    shape = 21,\n    col = \"white\",\n    stroke = 0.15\n  ) +\n  geom_text_repel(\n    data = . %>% filter(country %in% highlighted_countries),\n    aes(label = country),\n    fill = alpha(\"grey92\", 0.5),\n    segment.color = \"grey52\",\n    size = 1.5,\n    family = \"Roboto\",\n    fontface = \"bold\",\n    seed = 10,\n    point.padding = 0.25,\n    min.segment.length = 0,\n    segment.size = 0.25\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"#ef476f\",\n      \"#f78c6b\",\n      \"#ffd166\",\n      \"#06d6a0\",\n      \"#118ab2\",\n      \"#073b4c\"\n    ),\n    aesthetics = c(\"fill\", \"col\")\n  ) +\n  scale_size_area(\n    max_size = 20,\n    breaks = c(25, 100, 500, 1000) * 1e6,\n    labels = c(\"25M\", \"100M\", \"500M\", \"1B\"),\n  guide = guide_circles(\n    override.aes = aes(colour = \"grey45\"),\n    title = \"Population\",\n    text_position = \"ontop\",\n    # style just this guide\n    theme = theme(\n      legend.title = element_text(hjust = 0.5),\n      legend.text  = element_text(vjust = -0.5, size = 4)\n    )\n  )\n) +\n  guides(fill = \"none\",\n         color = \"none\") +\n  labs(\n    title = \"Global Tuberculosis Burden Across Regions\",\n    subtitle = \"Countries vary widely in how TB incidence translates into mortality, revealing unequal health outcomes across regions. Population size adds another layer, showing how the global burden falls unevenly around the world.\",\n    caption = cap,\n    x = \"Estimated TB Incidence per 100k\",\n    y = \"Estimated TB Mortality per 100k\"\n  ) +\n  theme_minimal(base_size = 7, base_family = \"Oswald\") +\n  theme(\n    plot.title = element_text(\n      size = 16,\n      face = \"bold\",\n      margin = margin(b = 5)\n    ),\n    plot.title.position = \"plot\",\n    plot.subtitle = element_textbox_simple(\n      family = \"Roboto\",\n      margin = margin(b = 7),\n      size = 8\n    ),\n    plot.caption = element_text(\n      color = \"grey45\",\n      size = 4.5,\n      hjust = 0,\n      halign = 0,\n      margin = margin(t = 7)\n    ),\n    plot.caption.position = \"plot\",\n    plot.margin = margin(5, 5, 5, 5),\n    panel.grid = element_blank(),\n    panel.background = element_rect(fill = \"grey95\", color = \"grey25\"),\n    plot.background = element_rect(fill = \"grey95\"),\n    strip.text = element_text(size = 10),\n    legend.position = c(0.04, 0.92)\n  ) +\n    transition_states(year) +\n    geom_text(aes(label = scales::number(year, accuracy = 1, big.mark = \"\"), \n                x = Inf, y = Inf), \n            stat = \"unique\", color = \"grey80\", size = 5,\n            family = \"Roboto\",\n            vjust = 1.2, hjust = 1.2)\n\np <- animate(p, height = 7, width = 7, units = \"in\", res = 300, renderer = magick_renderer(loop = FALSE))\n\np1 <- who_tb_data %>%\n  ggplot(aes(x = e_inc_100k, y = e_mort_100k)) +\n  facet_wrap( ~ g_whoregion, scales = \"free\") +\n  geom_point(\n    data = ~ filter(., !country %in% highlighted_countries),\n    aes(\n      size = e_pop_num,\n      colour = g_whoregion,\n      fill = stage(g_whoregion, after_scale = alpha(colorspace::desaturate(fill, 0.4), 0.2))\n    ),\n    shape = 21,\n    stroke = 0.2\n  ) +\n  geom_point(\n    data = ~ filter(., country %in% highlighted_countries),\n    aes(size = e_pop_num, fill = g_whoregion),\n    shape = 21,\n    col = \"white\",\n    stroke = 0.15\n  ) +\n  geom_text_repel(\n    data = . %>% filter(country %in% highlighted_countries),\n    aes(label = country),\n    fill = alpha(\"grey92\", 0.5),\n    segment.color = \"grey52\",\n    size = 1.5,\n    family = \"Roboto\",\n    fontface = \"bold\",\n    seed = 10,\n    point.padding = 0.25,\n    min.segment.length = 0,\n    segment.size = 0.25\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"#ef476f\",\n      \"#f78c6b\",\n      \"#ffd166\",\n      \"#06d6a0\",\n      \"#118ab2\",\n      \"#073b4c\"\n    ),\n    aesthetics = c(\"fill\", \"col\")\n  ) +\n  scale_size_area(\n    max_size = 20,\n    breaks = c(25, 100, 500, 1000) * 1e6,\n    labels = c(\"25M\", \"100M\", \"500M\", \"1B\"),\n  guide = guide_circles(\n    override.aes = aes(colour = \"grey45\"),\n    title = \"Population\",\n    text_position = \"ontop\",\n    # style just this guide\n    theme = theme(\n      legend.title = element_text(hjust = 0.5),\n      legend.text  = element_text(vjust = -0.5, size = 4)\n    )\n  )\n) +\n  guides(fill = \"none\",\n         color = \"none\") +\n  labs(\n    title = \"Global Tuberculosis Burden Across Regions\",\n    subtitle = \"Countries vary widely in how TB incidence translates into mortality, revealing unequal health outcomes across regions. Population size adds another layer, showing how the global burden falls unevenly around the world.\",\n    caption = cap,\n    x = \"Estimated TB Incidence per 100k\",\n    y = \"Estimated TB Mortality per 100k\"\n  ) +\n  theme_minimal(base_size = 7, base_family = \"Oswald\") +\n  theme(\n    plot.title = element_text(\n      size = 16,\n      face = \"bold\",\n      margin = margin(b = 5)\n    ),\n    plot.title.position = \"plot\",\n    plot.subtitle = element_textbox_simple(\n      family = \"Roboto\",\n      margin = margin(b = 7),\n      size = 8\n    ),\n    plot.caption = element_text(\n      color = \"grey45\",\n      size = 4.5,\n      hjust = 0,\n      halign = 0,\n      margin = margin(t = 7)\n    ),\n    plot.caption.position = \"plot\",\n    plot.margin = margin(5, 5, 5, 5),\n    panel.grid = element_blank(),\n    panel.background = element_rect(fill = \"grey95\", color = \"grey25\"),\n    plot.background = element_rect(fill = \"grey95\"),\n    strip.text = element_text(size = 10),\n    legend.position = c(0.04, 0.92)\n  )\n```\n:::\n\n\n#### 7. ðŸ’¾ Save\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save Animation\nanim_save(\"tt_45_2025.gif\", p)\n\n# Save the plot for TidyTuesday 2025, Week 45 with specified dimensions.\nandresutils::save_plot(p1, type = \"tidytuesday\", year = 2025, week = 45, width = 9, height = 9)\n```\n:::\n\n\n#### 8. ðŸš€ GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_45_2025.qmd`](https://github.com/OKcomputer626/Andres-Portfolio/blob/master/visualization/TidyTuesday/2025/tt_45_2025.qmd).\n\nFor the full repository, [click here](https://github.com/OKcomputer626/Andres-Portfolio).\n:::\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}