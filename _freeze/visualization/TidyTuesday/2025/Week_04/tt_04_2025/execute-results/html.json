{
  "hash": "a9040c9ea05ca2cd4b7131e88afa8dd6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Water Insecurity\"\ndescription: \"The tidycensus package in R is used to access and visualize U.S. Census data on social vulnerability indicators related to water insecurity in the Western U.S.\"\nlightbox: true\ndate: today\ncategories: [TidyTuesday, R Programming, Data Visualization]\ntags: [ggplot2, data-visualization, tidyverse]\nimage: \"tt_04_2025.png\"\neditor_options: \n  chunk_output_type: inline\n---\n\n\n\n![This visualization, created using ggplot2 in R, employs geom_line() to show changes in the percentage of the population lacking plumbing across 42 California counties from 2022 to 2023. The highlighted counties‚ÄîSutter, Tehama, Yolo, and San Benito‚Äîare emphasized in blue to indicate a 100% decrease, while Los Angeles County is shown in black to reflect its 14.8% decrease. The plot features direct labels for key counties using geom_text(), a clean background theme with theme_minimal(), and subtle gray lines for all counties to provide context.](tt_04_2025.png){#fig-1}\n\n### <mark> **How This Graphic Was Made** </mark>\n\n#### 1. üì¶ Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary packages using pacman for easier dependency management\npacman::p_load(\n  tidyverse,   # Collection of R packages for data science (ggplot2, dplyr, etc.)\n  showtext,    # Enables custom fonts for ggplot2\n  ggtext,      # Adds rich text formatting to ggplot2\n  skimr,       # Provides summary statistics in a readable format\n  janitor,\n  glue\n)\n\n# Add Google fonts\nfont_add_google(\"Roboto Condensed\", family = \"Roboto\")\nfont_add_google(\"Oswald\")\n\n# Add local font\nfont_add(\"Font Awesome 6 Brands\", here::here(\"fonts/otfs/Font Awesome 6 Brands-Regular-400.otf\"))\n\n# Automatically enable the use of showtext for all plots\nshowtext_auto()\n\n# Set DPI for high-resolution text rendering\nshowtext_opts(dpi = 300)\n```\n:::\n\n\n\n#### 2. üìñ Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the TidyTuesday data\ntuesdata <- tidytuesdayR::tt_load(2025, week = 4)\n\nwater_insecurity_2022 <- tuesdata$water_insecurity_2022 %>% clean_names()\nwater_insecurity_2023 <- tuesdata$water_insecurity_2023 %>% clean_names()\n\ntidytuesdayR::readme(tuesdata)\nrm(tuesdata)\n```\n:::\n\n\n\n#### 3. üïµÔ∏è Examine the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(water_insecurity_2022)\nskim(water_insecurity_2022)\n\nglimpse(water_insecurity_2023)\nskim(water_insecurity_2023)\n```\n:::\n\n\n\n#### 4. ü§º Wrangle Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncalifornia_water <- water_insecurity_2022 %>%\n  inner_join(\n    water_insecurity_2023, \n    by = c(\"geoid\", \"name\"), \n    suffix = c(\"_2022\", \"_2023\")\n  ) %>%\n  filter(str_detect(name, \"California\")) %>%\n  mutate(\n    difference = percent_lacking_plumbing_2023 - percent_lacking_plumbing_2022,\n    pct_change = case_when(\n      percent_lacking_plumbing_2022 == 0 & percent_lacking_plumbing_2023 > 0 ~ 100,  # Assign 100% if increasing from 0\n      percent_lacking_plumbing_2022 == 0 & percent_lacking_plumbing_2023 == 0 ~ 0,    # No change if both are 0\n      TRUE ~ round((difference / percent_lacking_plumbing_2022) * 100, 1)\n    )\n  ) %>%\n  drop_na() %>%  # Remove missing values after calculations\n  pivot_longer(\n    cols = starts_with(\"percent\"), \n    names_to = \"year\", \n    values_to = \"amount\"\n  ) %>%\n  mutate(\n    year = str_replace(year, \"percent_lacking_plumbing_\", \"\")\n  ) %>%\n  mutate(\n    county = str_remove(name, \" County, California\")\n  ) %>%\n  select(county, year, pct_change, amount)\n\ncalifornia_water_decrease <- california_water %>%\n  slice_min(pct_change)\n\ncalifornia_water_la <- california_water %>%\n  filter(county == \"Los Angeles\")\n```\n:::\n\n\n\n#### 5. üî§ Text\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntitle <- \"Percentage of the Population Lacking Plumbing in California\"\n\nst <- paste(\"Between 2022 and 2023, an analysis of 42 California counties found that Sutter, Tehama, Yolo, and San Benito saw a \", \n            \"<span style='color:#0375FC;'>**100% decrease**</span> in population lacking plumbing, while Los Angeles County‚ÄîCalifornia‚Äôs largest county by population‚Äîexperienced a \",\n            \"**14.8% decrease**.\")\n\n# Create a social media caption with customized colors and font for consistency in visualization\nsocial <- andresutils::social_caption(font_family = \"Roboto\", icon_color = \"black\") \n\n# Construct the final plot caption by combining TidyTuesday details, data source, and the social caption\ncap <- paste0(\n  \"#TidyTuesday: Week 04, 2025 | **Source**: U.S. Census Bureau, American Community Survey (ACS), via tidycensus | **Graphic**: \", social\n)\n```\n:::\n\n\n\n#### 6. üìä Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- california_water %>% \n  ggplot(aes(x = year, y = amount, group = county)) +\n  geom_line(data = california_water %>% filter(pct_change != min(pct_change), county != \"Los Angeles\"), color = \"#E0E0E0\") +\n  geom_line(data = california_water %>% slice_min(pct_change), color = \"#0375FC\", linewidth = 1.1) +\n  geom_line(data = california_water %>% filter(county %in% \"Los Angeles\"), color = \"black\", linewidth = 1.1) +\n  geom_text(data = california_water_decrease %>% filter(year == \"2022\"), aes(x = year, y = amount, label = paste0(county, \": \", round(amount, 2), \"%\")), hjust = 1.05, family = \"Roboto\", size = 3.25, color = \"#0375FC\") +\n  ggrepel::geom_text_repel(data = california_water_decrease %>% filter(year == \"2023\"), aes(x = year, y = amount, label = paste0(county, \": \", round(amount, 2), \"%\")), nudge_x = 0.15, segment.size = 0.2, direction = \"y\", hjust = \"left\", family = \"Roboto\", box.padding = 0.1, segment.linetype = 2, size = 3.25, color = \"#0375FC\") +\n  geom_text(data = california_water_la, aes(x = year, y = amount, label = paste0(county, \": \", round(amount, 2), \" %\"),  hjust = if_else(year == \"2022\", 1.05, -0.05)), family = \"Roboto\", size = 3.25, color = \"black\") +\n  geom_vline(xintercept = \"2022\", linewidth = 0.5, color = \"black\") + \n  geom_vline(xintercept = \"2023\", linewidth = 0.5, color = \"black\") + \n  geom_point(data = california_water_decrease, aes(x = year, y = amount), color = \"#0375FC\") +\n  geom_point(data = california_water_la, aes(x = year, y = amount), color = \"black\") +\n  coord_cartesian(clip = \"off\") +\n  labs(title = title,\n       subtitle = st, \n       caption = cap) +\n  theme_void() +\n  theme(plot.title = element_textbox_simple(family = \"Oswald\", size = 16, face = \"bold\", color = \"black\", margin = margin(b = 5, t = 5)),\n        plot.title.position = \"plot\",\n        plot.subtitle = element_textbox_simple(family = \"Roboto\", size = 10, color = \"black\", margin = margin(b = 15, t = 5), lineheight = 1),\n        plot.caption.position = \"plot\",\n        plot.caption = element_textbox_simple(size = 6, family = \"Roboto\", color = \"black\", margin = margin(t = 15), halign = 0.5),\n        axis.text.x = element_text(family = \"Roboto\", size = 9, hjust = 0.5, color = \"black\", vjust = -2),\n        plot.margin = margin(10, 10, 10, 10),\n        plot.background = element_rect(color = NA, fill = \"#FFFFFF\")) \n```\n:::\n\n\n\n#### 7. üíæ Save\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save plot with dimensions\nandresutils::save_plot(p, type = \"tidytuesday\", year = 2025, week = 4, width = 6, height = 6)\n```\n:::\n\n\n\n#### 8. üöÄ GitHub Repository\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for GitHub Repo\n\nThe complete code for this analysis is available in [`tt_04_2025.qmd`](https://github.com/OKcomputer626/Andres-Portfolio/blob/master/visualization/TidyTuesday/2025/Week_04/tt_04_2025.qmd).\n\nFor the full repository, [click here](https://github.com/OKcomputer626/Andres-Portfolio).\n:::\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}